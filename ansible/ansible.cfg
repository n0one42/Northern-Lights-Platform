# ansible/ansible.cfg

[defaults]
# --- Core Paths ---
# Establishes a clean, scalable structure for your Ansible content.
# All paths are relative to this ansible.cfg file.
roles_path              = roles
inventory               = inventories
collections_paths       = ./collections
# By setting these, you can easily add custom modules, filters, etc.
library                 = ./library
filter_plugins          = ./plugins/filter
action_plugins          = ./plugins/action

# --- Inventory Settings ---
# A robust ignore pattern to prevent Ansible from parsing non-inventory files.
# This avoids errors and keeps inventory processing clean.
inventory_ignore_patterns = .git, .vscode, __pycache__, collections, roles, plugins, .DS_Store, *.pyc, *.retry

# --- Python Interpreter ---
# Modern best practice. Automatically and quietly discovers the correct Python
# interpreter on the target host, reducing boilerplate and warnings.
interpreter_python      = auto_silent

# --- Security & Vault ---
# Enforce host key checking to prevent man-in-the-middle attacks. This is a
# critical security setting and should never be set to False in production.
host_key_checking       = True

# A placeholder for future Ansible Vault integration, the recommended way to
# manage all secrets in an enterprise-grade environment.
# vault_identity_list   = dev@~/.ansible/vault_pass.txt
# vault_password_file   = ~/.ansible/vault_pass.txt

# --- Performance & Output ---
# Determines how many hosts to manage in parallel. 5 is a safe default.
forks                   = 5
# Time in seconds to wait for a host to respond before timing out.
timeout                 = 30
# Disables the creation of .retry files, which keeps the project directory clean.
retry_files_enabled     = False
# This is a major developer experience improvement. It provides clean, structured,
# and colorized YAML output instead of verbose JSON.
stdout_callback         = yaml
# Complements the yaml callback by hiding skipped tasks, reducing noise so you
# can focus on what actually changed.
display_skipped_hosts   = False

# --- Facts Caching ---
# Caching facts dramatically speeds up playbook runs by avoiding redundant fact
# gathering for hosts that have been recently accessed.
fact_caching            = jsonfile
fact_caching_connection = ./.ansible_facts_cache
# Cache facts for one day (in seconds).
fact_caching_timeout    = 86400

[galaxy]
# Using a custom skeleton for new roles is a fantastic practice for enforcing
# consistency and your project's best practices from the start.
role_skeleton           = roles/_custom_skeleton
role_skeleton_ignore    = ^.git$,^.*/.git_keep$

[ssh_connection]
# NOTE: The section name must be [ssh_connection] (singular).
# Pipelining reduces the number of SSH operations required to execute a module,
# providing a significant performance boost.
pipelining              = True
# Advanced SSH arguments to enable connection multiplexing and keep-alives.
# This speeds up connections and makes them more resilient to network issues.
ssh_args                = -o ControlMaster=auto -o ControlPersist=60s -o ServerAliveInterval=30